<%-- 
    Document   : settingsSNSAngelGuard_Angels
    Created on : 31-mar-2011, 23:00:05
    Author     : tote
--%>

<%@page import="java.net.URLDecoder"%>
<%@page import="org.codehaus.jettison.json.JSONArray"%>
<%@page import="es.uah.cc.ie.sources.SNSdataBaseIntegrator"%>
<%@page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>

<%
            //Obtenemos la conexión a Facebook
            SNSdataBaseIntegrator snsDB = SNSdataBaseIntegrator.getSessionInstance(request);
            snsDB.logSession(request, response);
            //snsDB.getLoginFacebook(request, response);
            System.out.println("STTSNSAN: OBJETO ID: " + snsDB.getUserSettings().getUid());

            String hdAngels = "";
            String hdAngelsEd = "";
            String hdAngelsGoogleSelected = "";
            String hdLstAngelsFltWall = "";
            String hdLstAngelsFltFriends = "";
            String hdLstAngelsFltPriv = "";
            String hdLstAngelsFltVist = "";
            String hdActiveFltWall = "0";
            String hdActiveFltFriends = "0";
            String hdActiveFltPriv = "0";
            String hdActiveFltVist = "0";
            String hdFrecFltWall = "3";
            String hdFrecFltFriends = "3";
            String hdFrecFltPriv = "3";
            String hdFrecFltVist = "3";
            String hdAngelsAux = "";

            if (snsDB.isNewConnection()) {
                System.out.println("STTSNSAN: NUEVA CONEXION ");
                if (!snsDB.isInicio()) {
                    hdAngels = request.getParameter("hdAngels");
                    hdAngelsEd = request.getParameter("hdAngelsEd");
                    hdAngelsGoogleSelected = request.getParameter("hdAngelsGoogleSelected");
                    hdLstAngelsFltWall = request.getParameter("hdLstAngelsFltWall");
                    hdLstAngelsFltFriends = request.getParameter("hdLstAngelsFltFriends");
                    hdLstAngelsFltPriv = request.getParameter("hdLstAngelsFltPriv");
                    hdLstAngelsFltVist = request.getParameter("hdLstAngelsFltVist");
                    hdActiveFltWall = request.getParameter("hdActiveFltWall");
                    hdActiveFltFriends = request.getParameter("hdActiveFltFriends");
                    hdActiveFltPriv = request.getParameter("hdActiveFltPriv");
                    hdActiveFltVist = request.getParameter("hdActiveFltVist");
                    hdFrecFltWall = request.getParameter("hdFrecFltWall");
                    hdFrecFltFriends = request.getParameter("hdFrecFltFriends");
                    hdFrecFltPriv = request.getParameter("hdFrecFltPriv");
                    hdFrecFltVist = request.getParameter("hdFrecFltVist");
                    hdAngelsAux = request.getParameter("hdAngelsAux");
                } else {
                    System.out.println("CARGANDO DATOS 1");
                    hdAngels = "";
                    hdAngelsEd = "";
                    hdAngelsGoogleSelected = "";
                    hdLstAngelsFltWall = "";
                    hdLstAngelsFltFriends = "";
                    hdLstAngelsFltPriv = "";
                    hdLstAngelsFltVist = "";
                    hdActiveFltWall = "0";
                    hdActiveFltFriends = "0";
                    hdActiveFltPriv = "0";
                    hdActiveFltVist = "0";
                    hdFrecFltWall = "3";
                    hdFrecFltFriends = "3";
                    hdFrecFltPriv = "3";
                    hdFrecFltVist = "3";
                    hdAngelsAux = "";
                }
            } else {
                if (snsDB.isInicio()) {
                    System.out.println("CARGANDO DATOS 2");
                    snsDB.getUserSettings().setClientIntegrator(snsDB);
                    hdAngels = snsDB.getUserSettings().getAngelsUser("F");
                    hdAngelsEd = snsDB.getUserSettings().getAngelsUser("O");
                    hdAngelsGoogleSelected = snsDB.getUserSettings().getAngelsUser("G");

                    snsDB.getUserSettings().loadFilter("fltWall");
                    snsDB.getUserSettings().loadFilter("fltFriends");
                    snsDB.getUserSettings().loadFilter("fltPriv");
                    snsDB.getUserSettings().loadFilter("fltVist");

                    hdLstAngelsFltWall = snsDB.getUserSettings().getFltWall().getAngels();
                    hdLstAngelsFltFriends = snsDB.getUserSettings().getFltFriends().getAngels();
                    hdLstAngelsFltPriv = snsDB.getUserSettings().getFltPriv().getAngels();
                    hdLstAngelsFltVist = snsDB.getUserSettings().getFltVist().getAngels();

                    hdActiveFltWall = snsDB.getUserSettings().getFltWall().getActive();
                    hdActiveFltFriends = snsDB.getUserSettings().getFltFriends().getActive();
                    hdActiveFltPriv = snsDB.getUserSettings().getFltPriv().getActive();
                    hdActiveFltVist = snsDB.getUserSettings().getFltVist().getActive();

                    hdFrecFltWall = snsDB.getUserSettings().getFltWall().getFrec();
                    hdFrecFltFriends = snsDB.getUserSettings().getFltFriends().getFrec();
                    hdFrecFltPriv = snsDB.getUserSettings().getFltPriv().getFrec();
                    hdFrecFltVist = snsDB.getUserSettings().getFltVist().getFrec();
                    hdAngelsAux = snsDB.getUserSettings().getAngelsUser("F");
                    System.out.println("FIN CARGANDO DATOS 2");
                } else {
                    System.out.println("CARGANDO DATOS 3");
                    hdAngels = request.getParameter("hdAngels");
                    hdAngelsEd = request.getParameter("hdAngelsEd");
                    hdAngelsGoogleSelected = request.getParameter("hdAngelsGoogleSelected");
                    hdLstAngelsFltWall = request.getParameter("hdLstAngelsFltWall");
                    hdLstAngelsFltFriends = request.getParameter("hdLstAngelsFltFriends");
                    hdLstAngelsFltPriv = request.getParameter("hdLstAngelsFltPriv");
                    hdLstAngelsFltVist = request.getParameter("hdLstAngelsFltVist");
                    hdActiveFltWall = request.getParameter("hdActiveFltWall");
                    hdActiveFltFriends = request.getParameter("hdActiveFltFriends");
                    hdActiveFltPriv = request.getParameter("hdActiveFltPriv");
                    hdActiveFltVist = request.getParameter("hdActiveFltVist");
                    hdFrecFltWall = request.getParameter("hdFrecFltWall");
                    hdFrecFltFriends = request.getParameter("hdFrecFltFriends");
                    hdFrecFltPriv = request.getParameter("hdFrecFltPriv");
                    hdFrecFltVist = request.getParameter("hdFrecFltVist");
                    hdAngelsAux = request.getParameter("hdAngelsAux");
                    System.out.println("FIN CARGANDO DATOS 3");
                }
            }

            String[] arrayContacts = snsDB.getLocaleSettings().stringToArray(snsDB.getLocaleSettings().getTitleFriendsImportSettAng());
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"lang="es" xml:lang="es">
    <head>
        <title><%= snsDB.getLocaleSettings().getTitleSettAng()%></title>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />

        <link type="text/css" rel="stylesheet" href="Styles/facebook.css" />
        <link type="text/css" rel="stylesheet" href="Styles/fcbklistselection.css" />
        <link type="text/css" rel="stylesheet" href="Styles/jquery.loader.css" />

        <script type="text/javascript" charset="ISO-8859-1" src="js/jquery.corner.js"></script>
        <script type="text/javascript" charset="ISO-8859-1" src="js/AjaxFlagMenu-1.0.2.min.js"></script>
        <script type="text/javascript" charset="ISO-8859-1" src="js/jquery.loader.js"></script>

        <script type="text/javascript" charset="ISO-8859-1" src="js/jquery.corner.js"></script>
        <script type="text/javascript" charset="ISO-8859-1" src="js/fcbklistselection.js"></script>
        <script type="text/javascript" charset="ISO-8859-1" src="js/utilidadesFormularios.js"></script>

        <script type="text/javascript" >
            $(function() {
                loadInicioDates('<%= hdAngels%>','<%= hdAngelsEd%>','<%= hdAngelsGoogleSelected%>',
                '<%= hdLstAngelsFltWall%>','<%= hdLstAngelsFltFriends%>','<%= hdLstAngelsFltPriv%>','<%= hdLstAngelsFltVist%>',
                '<%= hdActiveFltWall%>','<%= hdActiveFltFriends%>','<%= hdActiveFltPriv%>','<%= hdActiveFltVist%>',
                '<%= hdFrecFltWall%>','<%= hdFrecFltFriends%>','<%= hdFrecFltPriv%>','<%= hdFrecFltVist%>','<%= hdAngelsAux%>');
            });
        </script>
    </head>
    <body>
        <form id="frSNSAngels" action="" method="">
            <input type="hidden" id="hdAngels" name="hdAngels" value="" />
            <input type="hidden" id="hdAngelsEd" name="hdAngelsEd" value="" />
            <input type="hidden" id="hdAngelsEdAux" name="hdAngelsEdAux" value="" />
            <input type="hidden" id="hdAngelsGoogleSelected" name="hdAngelsGoogleSelected" value="" />
            <input type="hidden" id="hdAngelsGoogleSelectedAux" name="hdAngelsGoogleSelectedAux" value="" />
            <input type="hidden" id="hdLstAngelsFltWall" name="hdLstAngelsFltWall" value="" />
            <input type="hidden" id="hdLstAngelsFltFriends" name="hdLstAngelsFltFriends" value="" />
            <input type="hidden" id="hdLstAngelsFltPriv" name="hdLstAngelsFltPriv" value="" />
            <input type="hidden" id="hdLstAngelsFltVist" name="hdLstAngelsFltVist" value="" />
            <input type="hidden" id="hdActiveFltWall" name="hdActiveFltWall" value="0" />
            <input type="hidden" id="hdActiveFltFriends" name="hdActiveFltFriends" value="0" />
            <input type="hidden" id="hdActiveFltPriv" name="hdActiveFltPriv" value="0" />
            <input type="hidden" id="hdActiveFltVist" name="hdActiveFltVist" value="0" />
            <input type="hidden" id="hdFrecFltWall" name="hdFrecFltWall" value="0" />
            <input type="hidden" id="hdFrecFltFriends" name="hdFrecFltFriends" value="0" />
            <input type="hidden" id="hdFrecFltPriv" name="hdFrecFltPriv" value="0" />
            <input type="hidden" id="hdFrecFltVist" name="hdFrecFltVist" value="0" />
            <input type="hidden" id="hdAngelsAux" name="hdAngelsAux" value="0" />

            <div id="friendsContent" class="friendsContent">
                <h1 class="tituloMed"><%= snsDB.getLocaleSettings().getTitleFriendsContentSettAng()%></h1>
                <ul id="fcbklist">
                </ul>
            </div>
            <div id="friendsGoogleImport" class="friendsGoogleImport">
                <h1 class="tituloMed"><%= arrayContacts[0]%></h1>
                <table width="100%">
                    <tr>
                        <td width="80%">
                            <table>
                                <tr>
                                    <td>
                                        <div id="contactContainerGoogle" style="margin:5px;">
                                            <div id="contactContentGoogle" class="contactContentGoogle">
                                                <table id="tabContacts">
                                                    <tr class="pijama1">
                                                        <td width="25px"></td>
                                                        <td width="230px"></td>
                                                        <td width="230px"></td>
                                                    </tr>
                                                    <tr class="pijama1">
                                                        <td width="25px"></td>
                                                        <td width="230px"></td>
                                                        <td width="230px"></td>
                                                    </tr>
                                                    <tr class="pijama1">
                                                        <td width="25px"></td>
                                                        <td width="230px"></td>
                                                        <td width="230px"></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td width="20%" align="right">
                            <table>
                                <tr>
                                    <td width="100%" align="right">
                                        <input type="button" class="boton" id="btnImport" name="btnImport" value="<%= snsDB.getLocaleSettings().getBtnImportSettAng()%>"
                                               onclick="setWinOpen();lanzarModal('http://oe.dynalias.net:8080/SNSAngelGuardFB/modalContacts.jsp',700,420);"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="100%" align="right">
                                        <input type="button" class="botonDisabled" id="btnDelContact" name="btnDelContact" value="Borrar"
                                               onclick="borrarContactGoogle();"/>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
            <div id="friendsImport" class="friendsImport">
                <h1 class="tituloMed"><%= arrayContacts[1]%></h1>
                <div id="friendsImportContainer" class="friendsImportContainer" style="margin:5px;">
                    <table id="tabFriendsImport" width="100%">
                        <tr class="imgContent">
                            <td width="15%" align="center">
                                <center>
                                    <h1 class="tituloMed">1.</h1>
                                </center>
                            </td>
                            <td width="40%" align="right">
                                <label for="txtNameTutorEd0"><%= snsDB.getLocaleSettings().getTxtNameTutorSettAng()%></label>
                                <input type="text" name="txtNameTutorEd0" id="txtNameTutorEd0" size="25" maxlength="70" onchange="isDatesTutorValid(0);"
                                       value="" />
                            </td>
                            <td width="55%" align="right">
                                <label for="txtEmailTutorEd0"><%= snsDB.getLocaleSettings().getTxtEmailTutorSettAng()%></label>
                                <input type="text" name="txtEmailTutorEd0" id="txtEmailTutorEd0" size="25" maxlength="70" onchange="isDatesTutorValid(0);"
                                       value="" />
                            </td>
                        </tr>
                        <tr class="imgContent">
                            <td width="5%" align="center">
                                <img alt="Nuevo contacto"  class="newAngel" src="http://oe.dynalias.net:8080/SNSAngelGuardFB/resources/anadir.gif"
                                     onclick="pintarNuevoContacto(1,'<%= snsDB.getLocaleSettings().getTxtNameTutorSettAng()%>','<%= snsDB.getLocaleSettings().getTxtEmailTutorSettAng()%>');"> </img>
                            </td>
                            <td width="40%" align="right">
                            </td>
                            <td width="55%" align="right">
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </form>
    </body>
</html>
